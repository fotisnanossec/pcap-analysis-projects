# Network Traffic Analysis: Malware Compromise from `modandcrackedapk.com`

## Project Overview
This project documents a thorough network forensics analysis of a PCAP file obtained from a public security exercise. The objective was to identify the source and nature of a network compromise, trace the infection chain, and report on the findings.

The PCAP file used for this analysis was sourced from the following exercise on **Malware-Traffic-Analysis.net**:
- **Source Link:** `https://www.malware-traffic-analysis.net/2024/11/26/index.html`

## Analysis Methodology
The analysis was performed using a systematic approach:
1.  **Initial Triage:** Network flows and conversations were examined using custom scripts to identify unusual connections.
2.  **DNS Analysis:** DNS queries were scrutinized using a dedicated Python script to find initial contact domains.
3.  **Threat Intelligence:** Identified domains and IP addresses were cross-referenced with external threat intelligence sources like VirusTotal.
4.  **C2 Traffic Identification:** Flows with unique characteristics (e.g., unusual user agents, beaconing patterns) were isolated using a combination of `tshark` filters and custom scripts.
5.  **Conclusion & Reporting:** All findings were compiled into a formal incident report with a timeline and recommendations.

## Tools Used
- **Tshark:** For filtering and extracting specific network flow information from the command line.
- **Python Scripts:** The custom `pcap_triage`, `dns_agnent`, and `http_agent` scripts from this repository were used to automate portions of the analysis.
- **VirusTotal:** For validating the malicious nature of domains and IPs.

### **Key Findings**

* **Initial Access:** The host was compromised after performing a DNS query for `modandcrackedapk[.]com`, a known malicious domain.
* **Infection Vector:** The malicious domain redirected the host to `193[.]42[.]38[.]139` to download the payload over an encrypted TLS channel.
* **Implant:** The downloaded malware was identified as a `NetSupport Manager` implant, which was used to establish a persistent C2 channel.
* **C2 Communication:** The implant beaconed to the IP address `194[.]180[.]191[.]64` using the User-Agent `NetSupport Manager/1.3`.
* **Data Exfiltration:** The host was observed uploading large volumes of data to the C2 server, confirming a data exfiltration event.

## Folder Contents
- `data/`: Contains the original PCAP file used for the analysis.
- `reports/`: Contains the full, detailed incident report in PDF or Markdown format.

[**View the full Incident Report**](./reports/Incident_Report_modandcrackedapk.md)
